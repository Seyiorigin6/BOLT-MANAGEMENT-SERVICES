<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register — Bolt Management Services</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/public.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="register-page">
    
    <!-- Header -->
    <header>
            <div class="container header-container">
                <div class="logo">
                    <h1>⚡Bolt</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="help.html">Help</a></li>
                        <li><a href="login.html" class="cta-button">Login</a></li>
                    </ul>
                </nav>
            </div>
        </header>

     <!-- Register Form Section -->
    <section id="register-form-section">
      <div class="container register-container">
        <h1>Register</h1>
        <p>Create your account and join Bolt today.</p>
        <form id="register-form">

          <label for="name">Full Name</label>
          <input type="text" id="name" name="name" placeholder="Enter your full name">
          <small class="error-message" id="name-error"></small>

          <label for="phone">Phone Number</label>
          <input type="text" id="phone" name="phone" placeholder="Enter your phone number">
          <small class="error-message" id="phone-error"></small>

          <label for="email">Email</label>
          <input type="email" id="email" name="email" placeholder="Enter your email">
          <small class="error-message" id="email-error"></small>

          <label for="password">Password</label>
          <input type="password" id="password" name="password" placeholder="Enter your password">
          <small class="error-message" id="password-error"></small>

          <label for="confirm-password">Confirm Password</label>
          <input type="password" id="confirm-password" name="confirm-password" placeholder="Confirm your password">
          <small class="error-message" id="confirm-password-error"></small>

          <label for="user-type">Register as</label>
          <select id="user-type" name="user-type">
            <option value="customer" selected>Customer</option>
            <option value="driver">Driver</option>
          </select>
          <small class="error-message" id="user-type-error"></small>

          <div id="licence-field" style="display: none;">
            <label for="licence-number">Licence Number</label>
            <input type="text" id="licence-number" name="licence-number" placeholder="Enter your licence number">
            <small class="error-message" id="licence-number-error"></small>
          </div>

          <button type="submit" class="cta-button">Register</button>

          <p class="login-footer-text">
            Already have an account? <a href="login.html">Login here</a>
          </p>
        </form>
      </div>
    </section>

    <!-- Footer -->
    <footer>
            <div class="container footer-container">
                <div class="footer-links">
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="help.html">Help</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <li><a href="terms.html">Terms & Conditions</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="footer-socials">
                    <p>Follow us on:</p>
                    <a href="https://www.tiktok.com/@bolt?lang=en" target="_blank">TikTok</a> |
                    <a href="https://x.com/boltapp" target="_blank">X</a> |
                    <a href="https://www.instagram.com/bolt_nigeria/?hl=en" target="_blank">Instagram</a>
                </div>
                <div class="footer-cta">
                    <a href="https://play.google.com/store/apps/details?id=ee.mtakso.client&hl=en" class="cta-button" target="_blank">Get Bolt App</a>
                    <a href="https://play.google.com/store/apps/details?id=ee.mtakso.driver&hl=en" class="cta-button" target="_blank">Get Bolt Drivers</a>
                </div>
                <p style="margin-top:1rem; opacity:0.8;">&copy; <span id="year"></span> Bolt Management Services</p>
            </div>
        </footer>
  </div>
  <!-- JS -->
  <script>
    /* -------------------- Register -------------------- */
    (function () {
      const registerForm = document.getElementById('register-form');
      if (!registerForm) return; // not on register page -> exit
    
      const userTypeSelect = document.getElementById('user-type');
      const licenceField = document.getElementById('licence-field');
      const licenceInput = document.getElementById('licence-number');
    
      // ensure licence wrapper visibility matches current selection
      if (userTypeSelect && licenceField) {
        licenceField.style.display = userTypeSelect.value === 'driver' ? 'block' : 'none';
        userTypeSelect.addEventListener('change', () => {
          licenceField.style.display = userTypeSelect.value === 'driver' ? 'block' : 'none';
        });
      }
    
      // helper: show inline error
      function showError(id, message) {
        const el = document.getElementById(id);
        if (el) el.textContent = message;
      }
      function clearErrors() {
        registerForm.querySelectorAll('.error-message').forEach(e => e.textContent = '');
      }
    
      // simple localStorage users store for development (NOT secure, only for dev)
      function getUsers() {
        try {
          return JSON.parse(localStorage.getItem('bolt_users') || '[]');
        } catch (e) {
          return [];
        }
      }
      function saveUser(user) {
        const users = getUsers();
        users.push(user);
        localStorage.setItem('bolt_users', JSON.stringify(users));
      }
      function isEmailTaken(email) {
        return getUsers().some(u => u.email.toLowerCase() === email.toLowerCase());
      }
    
      registerForm.addEventListener('submit', (ev) => {
        ev.preventDefault();
        clearErrors();
      
        // grab values
        const name = (document.getElementById('name')?.value || '').trim();
        const phone = (document.getElementById('phone')?.value || '').trim();
        const email = (document.getElementById('email')?.value || '').trim();
        const password = (document.getElementById('password')?.value || '').trim();
        const confirmPassword = (document.getElementById('confirm-password')?.value || '').trim();
        const userType = (document.getElementById('user-type')?.value || '').trim();
        const licenceNumber = (document.getElementById('licence-number')?.value || '').trim();
      
        let hasError = false;
      
        // required checks
        if (!name) { showError('name-error', 'Name is required'); hasError = true; }
        if (!phone) { showError('phone-error', 'Phone number is required'); hasError = true; }
        if (!email) { showError('email-error', 'Email is required'); hasError = true; }
        if (!password) { showError('password-error', 'Password is required'); hasError = true; }
        if (!confirmPassword) { showError('confirm-password-error', 'Please confirm password');     hasError = true; }
        if (!userType) { showError('user-type-error', 'Please select a user type'); hasError = true; }
      
        // email format
        if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          showError('email-error', 'Invalid email address'); hasError = true;
        }
      
        // password length & match
        if (password && password.length < 6) {
          showError('password-error', 'Password must be at least 6 characters'); hasError = true;
        }
        if (password && confirmPassword && password !== confirmPassword) {
          showError('confirm-password-error', 'Passwords do not match'); hasError = true;
        }
      
        // licence required for drivers
        if (userType === 'driver') {
          if (!licenceNumber) {
            showError('licence-number-error', 'Licence number is required for drivers'); hasError =     true;
          }
        }
      
        if (hasError) {
          // stop and show errors
          return;
        }
      
        // Check if email already registered (dev)
        if (isEmailTaken(email)) {
          showError('email-error', 'This email is already registered');
          return;
        }
      
        // Save user to localStorage for dev testing (not secure)
        const newUser = {
          id: 'U' + Date.now(),
          name,
          phone,
          email,
          password,       // NOTE: in production you would NEVER store plain passwords
          userType,
          licenceNumber: userType === 'driver' ? licenceNumber : '',
          createdAt: new Date().toISOString()
        };
        saveUser(newUser);
      
        // Redirect to user-type dashboard (adjust paths to your project)
        if (userType === 'customer') {
          window.location.href = 'customer/customerhome.html';
        } else if (userType === 'driver') {
          window.location.href = 'driver/driver-dashboard.html';
        } else {
          window.location.href = 'index.html';
        }
      });
    })();

  </script>
</body>
</html>
